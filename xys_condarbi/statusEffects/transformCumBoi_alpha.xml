<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<statusEffect>
	<renderingPriority>70</renderingPriority>
	<renderInEffectsPanel>true</renderInEffectsPanel>
	<beneficial>DETRIMENTAL</beneficial>
	<combatEffect>false</combatEffect>
	<sexEffect>true</sexEffect>
	<name><![CDATA[Transformative Cum (Alpha)]]></name>
	<description><![CDATA[
		[npc.NamePos] cum has become so potent, that aside from [style.colourSex(turning [npc.her] sexual partners into futanaries)], it will now also try to [style.boldTfSex(transform them into [npc.her] race!)]
	]]></description>
	<imageName>transformCum.svg</imageName>
	<!-- https://github.com/Innoxia/liliths-throne-public/blob/dev/src/com/lilithsthrone/utils/colours/PresetColour.java -->
	<colourPrimary>BASE_PINK</colourPrimary>
	<!-- This has to have a value defined, or else this XML file will fail to load. -->
	<secondaryColours/><!-- This can optionally be left blank, like the 'colourTertiary' element below. -->
	<colourTertiary/>
	
	<!-- https://github.com/Innoxia/liliths-throne-public/blob/dev/src/com/lilithsthrone/game/character/attributes/Attribute.java-->
	<attributeModifiers>
		<modifier value='100'>VIRILITY</modifier>
		<modifier value='100'>FERTILITY</modifier>
		<modifier value='50'>RESTING_LUST</modifier>
	</attributeModifiers>
	<combatMoves/>
	<spells/>
	
	<extraEffects>
		<effect><![CDATA[[style.boldTfSex(Orgasms transform sex partners into [npc.fullRace(true)] futanaries!)]]]></effect>
	</extraEffects>
	<applicationCondition><![CDATA[
		false
	]]></applicationCondition>
	
	<applyEffect><![CDATA[
		#IF(game.isInSex() && npc == sex.getCharacterOrgasming() && sex.isReadyToOrgasm(npc) && npc.hasPenisIgnoreDildo() && npc.getPenisRawCumExpulsionValue() != 0)
			[##
				function transformCum(partner) {
					if(partner.getTrueRace() != RACE_DEMON && !partner.isUnique() && !partner.getFetishDesire(FETISH_TRANSFORMATION_RECEIVING).isNegative()) {
						var targetBody = npc.getTrueRace().getRacialBody();
						
						if(partner.getTrueRace() != npc.getTrueRace() && partner.isAbleToHaveRaceTransformed()) {
							partner.setBody(partner.getGender(), npc.getSubspecies(), npc.getRaceStage(), false);
							game.appendToTextEndStringBuilder(partner, "<p>[npc.She] [npc.verb(shudder)] slightly as the cum seeps into [npc.her] [npc.materialSkin], transforming [npc.herHim] into a [npc.race(true)]!</p>");
						};

						if(!partner.hasPenisIgnoreDildo())
							game.appendToTextEndStringBuilder(partner.setPenisType(targetBody.getPenisType()));
						if(partner.getPenisRawSizeValue() < PENIS_LENGTH_FIVE_ENORMOUS.getMedianValue()) 
							game.appendToTextEndStringBuilder(partner.incrementPenisSize(5));
						if(partner.getTesticleSize().getValue() < 7) 
							game.appendToTextEndStringBuilder(partner.incrementTesticleSize(1));
						if(partner.getPenisRawCumStorageValue() < CUM_PRODUCTION_SIX_EXTREME.getMedianValue() || Math.random() < 0.2) 
							game.appendToTextEndStringBuilder(partner.incrementPenisCumStorage(200));
						if(partner.getPenisRawCumProductionRegenerationValue() < 500000) 
							game.appendToTextEndStringBuilder(partner.incrementPenisCumProductionRegeneration(5000));
						if(game.isMuskContentEnabled() && !partner.hasCumModifier(FLUID_MODIFIER_MUSKY)) 
							game.appendToTextEndStringBuilder(partner.addCumModifier(FLUID_MODIFIER_MUSKY));
						if(!partner.hasCumModifier(FLUID_MODIFIER_VISCOUS)) 
							game.appendToTextEndStringBuilder(partner.addCumModifier(FLUID_MODIFIER_VISCOUS));
						if(!partner.hasCumModifier(FLUID_MODIFIER_ADDICTIVE)) 
							game.appendToTextEndStringBuilder(partner.addCumModifier(FLUID_MODIFIER_ADDICTIVE));
						game.appendToTextEndStringBuilder(partner.incrementAttribute(ATTRIBUTE_VIRILITY, 10));
					
						if(!partner.hasBreasts())
							game.appendToTextEndStringBuilder(partner.setBreastType(targetBody.getBreastType()));
						if(partner.getBreastRawSizeValue() < 15) 
							game.appendToTextEndStringBuilder(partner.incrementBreastSize(1));
					
						if(!partner.hasVagina())
							game.appendToTextEndStringBuilder(partner.setVaginaType(targetBody.getVaginaType()));
						if(partner.getVaginaWetness().getValue() < 5) 
							game.appendToTextEndStringBuilder(partner.incrementVaginaWetness(1));
						if(partner.getVaginaElasticity().getValue() < 7) {
							game.appendToTextEndStringBuilder(partner.incrementVaginaElasticity(1));
						} else if(partner.getVaginaRawCapacityValue() > 1) {
							game.appendToTextEndStringBuilder(partner.incrementVaginaCapacity(-1, true));
						};
						if(partner.getVaginaPlasticity().getValue() > 0)
							game.appendToTextEndStringBuilder(partner.incrementVaginaPlasticity(-1));
						if(!partner.isVaginaSquirter()) 
							game.appendToTextEndStringBuilder(partner.setVaginaSquirter(true));
						game.appendToTextEndStringBuilder(partner.incrementAttribute(ATTRIBUTE_FERTILITY, 10));
					
						if(partner.getFemininityValue() < FEMININITY_FEMININE.getMedianFemininity())
							game.appendToTextEndStringBuilder(partner.incrementFemininity(10));
					
						if(!partner.hasFetish(FETISH_CUM_STUD)){
							game.appendToTextEndStringBuilder(partner.addFetish(FETISH_CUM_STUD));
						};
						if(!partner.hasFetish(FETISH_CUM_ADDICT)){
							game.appendToTextEndStringBuilder(partner.addFetish(FETISH_CUM_ADDICT));
						};

						if(!partner.hasStatusEffect(SE_xys_condarbi_transformCumBoi_alpha)) {
							partner.addStatusEffect(SE_xys_condarbi_transformCumBoi, 21600);
						};
					};
				};
			]
			[##
				function getPartners(characterMap) {
					characterMap.remove(npc); 
					characterMap.keySet().forEach(transformCum);
				}
			]
			[##sex.getOngoingActionsMap(npc).values().stream().forEach(getPartners)]
		#ENDIF
	]]></applyEffect>
	
	<applyRemovalEffect/>
	
	<applyPostRemovalEffect/>
	
</statusEffect>
